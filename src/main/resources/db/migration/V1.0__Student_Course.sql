CREATE TABLE COURSE (
    ID INTEGER GENERATED BY DEFAULT AS IDENTITY,
    NAME VARCHAR(255),
    PRIMARY KEY (ID)
);

CREATE TABLE STUDENT (
    ID INTEGER GENERATED BY DEFAULT AS IDENTITY,
    NAME VARCHAR(255),
    PRIMARY KEY (ID)
);
CREATE TABLE STUDENT_COURSE_REGISTRATION (
    ID INTEGER GENERATED BY DEFAULT AS IDENTITY,
    COURSE_ID INTEGER,
    STUDENT_ID INTEGER,
    PRIMARY KEY (ID),
    CONSTRAINT FK_STUDENT_COURSE_REGISTRATION_COURSE_ID FOREIGN KEY (COURSE_ID) REFERENCES COURSE,
    CONSTRAINT FK_STUDENT_COURSE_REGISTRATION_STUDENT_ID FOREIGN KEY (STUDENT_ID) REFERENCES STUDENT,
    UNIQUE UK_STUDENT_COURSE_REGISTRATION_STUDENT_ID_COURSE_ID (STUDENT_ID, COURSE_ID)
);

CREATE TABLE STUDENT_COURSE_SCORE (
    ID INTEGER GENERATED BY DEFAULT AS IDENTITY,
    SCORE DOUBLE,
    REGISTRATION_ID INTEGER,
    PRIMARY KEY (ID),
    CONSTRAINT FK_STUDENT_COURSE_SCORE_REGISTRATION_ID FOREIGN KEY (REGISTRATION_ID) REFERENCES STUDENT_COURSE_REGISTRATION
);

CREATE INDEX IDX_COURSE_NAME ON COURSE (NAME);